# Values for conversation-history
# Generated by register-app.sh, customized for MCP with external PostgreSQL

image:
  repository: registry.home.mcztest.com/conversation-history
  tag: latest
  pullPolicy: Always

service:
  port: 80
  targetPort: 8000

ingress:
  enabled: true
  host: conversation-history.home.mcztest.com

mcp:
  enabled: true
  transport: streamable-http

# MCP apps typically use TCP health checks (no /health endpoint)
healthCheck:
  enabled: true
  http:
    enabled: false
  tcp:
    enabled: true
    port: http

# External PostgreSQL (already deployed separately)
postgres:
  enabled: true
  external:
    enabled: true
    host: postgres.conversation-history.svc.cluster.local
    port: 5432
    database: conversation_history
    user: convo_user
    existingSecret: conversation-history-secrets
    passwordKey: database-password

# Additional environment variables for OpenAI and source database
env:
  - name: OPENAI_API_KEY
    valueFrom:
      secretKeyRef:
        name: conversation-history-secrets
        key: openai-api-key
  # Source database for agent-progress import
  - name: SOURCE_DATABASE_HOST
    value: "agent-progress-postgres.agent-progress.svc.cluster.local"
  - name: SOURCE_DATABASE_PORT
    value: "5432"
  - name: SOURCE_DATABASE_NAME
    value: "agent_progress"
  - name: SOURCE_DATABASE_USER
    value: "agent_progress"
  - name: SOURCE_DATABASE_PASSWORD
    valueFrom:
      secretKeyRef:
        name: conversation-history-secrets
        key: source-database-password

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi
