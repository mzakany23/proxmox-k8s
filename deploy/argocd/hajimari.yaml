# ArgoCD Application for Hajimari dashboard
# Uses external Hajimari Helm chart (not the shared homelab-app chart)
# Replaces app-registry and dashboard
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: hajimari
  namespace: argocd
  labels:
    app.kubernetes.io/managed-by: argocd
    homelab.mcztest.com/type: dashboard
    homelab.mcztest.com/managed-by: individual
spec:
  project: default
  source:
    repoURL: https://hajimari.io
    targetRevision: 2.0.2
    chart: hajimari
    helm:
      releaseName: hajimari
      valueFiles: []
      values: |
        image:
          repository: ghcr.io/toboshii/hajimari
          tag: v0.3.1

        hajimari:
          title: "Homelab"
          lightTheme: gazette
          darkTheme: tron
          showGreeting: false
          showSearch: false
          showAppGroups: true
          showAppUrls: false
          showAppInfo: true
          showAppStatus: false
          defaultEnable: false

          namespaceSelector:
            matchNames:
              - apps

          customApps:
            - group: MCP Servers
              apps:
                - name: Agent Progress
                  url: https://agent-progress.home.mcztest.com
                  icon: mdi:robot
                  info: Workflow tracking for AI agents
                - name: Conversation History
                  url: https://conversation-history.home.mcztest.com
                  icon: mdi:message-text-clock
                  info: Semantic search for conversations
                - name: NC Soccer
                  url: https://ncsoccer.home.mcztest.com
                  icon: mdi:soccer
                  info: Soccer predictions and standings
                - name: Perfin Analysis
                  url: https://perfin-analysis.home.mcztest.com
                  icon: mdi:chart-line
                  info: Budget modeling and spending analysis
                - name: Monarch Money
                  url: https://monarch-money.home.mcztest.com
                  icon: mdi:currency-usd
                  info: Financial data and transactions
                - name: Proxmox K8s
                  url: https://proxmox-k8s.home.mcztest.com
                  icon: mdi:kubernetes
                  info: Kubernetes cluster management
            - group: Infrastructure
              apps:
                - name: ArgoCD
                  url: https://argocd.home.mcztest.com
                  icon: simple-icons:argo
                  info: GitOps deployment
                - name: Gitea
                  url: https://gitea.home.mcztest.com
                  icon: simple-icons:gitea
                  info: Git server
                - name: Grafana
                  url: https://grafana.home.mcztest.com
                  icon: simple-icons:grafana
                  info: Monitoring dashboards
                - name: Prometheus
                  url: https://prometheus.home.mcztest.com
                  icon: simple-icons:prometheus
                  info: Metrics collection
            - group: VMs
              apps:
                - name: Proxmox
                  url: https://proxmox.home.mcztest.com
                  icon: simple-icons:proxmox
                  info: Hypervisor management
                - name: Pi-hole
                  url: https://pihole.home.mcztest.com/admin
                  icon: simple-icons:pihole
                  info: DNS and ad blocking
                - name: Home Assistant
                  url: https://homeassistant.home.mcztest.com
                  icon: simple-icons:homeassistant
                  info: Home automation
                - name: Ubuntu Desktop
                  url: https://desktop.home.mcztest.com/vnc.html?autoconnect=true
                  icon: simple-icons:ubuntu
                  info: Remote desktop

          globalBookmarks:
            - group: Quick Links
              bookmarks:
                - name: GitHub
                  url: https://github.com/mzakany23/proxmox-k8s

        ingress:
          main:
            enabled: true
            ingressClassName: nginx
            annotations:
              cert-manager.io/cluster-issuer: letsencrypt-cloudflare
            hosts:
              - host: home.mcztest.com
                paths:
                  - path: /
                    pathType: Prefix
            tls:
              - secretName: hajimari-tls
                hosts:
                  - home.mcztest.com

        persistence:
          data:
            enabled: false

        resources:
          requests:
            cpu: 50m
            memory: 64Mi
          limits:
            cpu: 100m
            memory: 128Mi
  destination:
    server: https://kubernetes.default.svc
    namespace: apps
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
